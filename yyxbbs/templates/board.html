<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>title</title>
    <!-- å¼€å‘ç‰ˆæœ¬ -->
    <link rel="stylesheet" href="../static/bootstrap/css/bootstrap.css">
    <!-- ç”Ÿäº§ç‰ˆæœ¬ -->
    <!-- <link rel="stylesheet" href="../static/bootstrap/css/bootstrap.css"> -->
    <!-- è®¾ç½®èƒŒæ™¯é¢œè‰² -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--å¯¼å…¥å­—ä½“çš„css-->
    <link herf="../static/bootstrap/css/myfont.css" rel="stylesheet">
    <!-- å¯¼å…¥å¯¼èˆªæ æ–‡ä»¶ -->
    <link rel="stylesheet" href="../static/bootstrap/css/navstyle.css">
    <!-- å¯¼å…¥å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <!-- å¯¼å…¥æµ®åŠ¨è¯„è®ºåŒºæ ·å¼css -->
    <link rel="stylesheet" href="../static/bootstrap/css/commentfloat.css">

    
    
</head>

<body>
     <!-- å¯¼èˆªæ  -->
     <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <!-- è¿™é‡Œå…ˆç”¨#-->
                <a class="navbar-brand" href="#">æ™®é€šçš„ç•™è¨€æ¿</a> 
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="/board">ç•™è¨€æ¿</a></li>
                    <li><a href="/PersonInfo">ä¸ªäººä¿¡æ¯</a></li>
                    <li><a href="/DailyAttendance">æ¯æ—¥ç­¾åˆ°</a></li>
                    <li><a href="#">å°æ¸¸æˆ</a></li>
                    <li><a href="/DeepSeek">DeepSeek</a></li>
                </ul>
            </div>
        </div>
    </nav>
     <!-- éœ€è¦åšæˆä¸€å—ä¸€å—çš„è¯„è®º -->
     <div class="container" style="margin-top: 60px;">
        <div class="row">
            <!-- éå†ç•™è¨€å¹¶å±•ç¤º -->
            {% for comment in comments %}
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>{{ comment.username }}</h4>
                            <p>{{ comment.board_date }}</p>
                        </div>
                        <div class="panel-body">
                            <!-- æ˜¾ç¤ºå¯Œæ–‡æœ¬å†…å®¹ -->
                            <div class="content">
                                {{ comment.content|safe }}
                            </div>
                        </div>
                        <div class="panel-footer">
                            <p>ç‚¹èµæ•°: {{ comment.like_point }}</p>
                            <button class="btn btn-primary btn-sm" onclick="likeComment({{ comment.id }})">
                                ğŸ‘ ç‚¹èµ
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>


        <!-- å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
        <div id="editor-container"></div>
        <!-- ä½¿ç”¨ form è¡¨å•æäº¤å¯Œæ–‡æœ¬å†…å®¹ -->
        <form method="POST" action="/RichTextSubmit/" id="comment-form">
            <!-- éšè—çš„ textarea æ¥å­˜å‚¨å¯Œæ–‡æœ¬å†…å®¹ -->
            {% csrf_token %}
            <textarea name="content" id="comment-content" style="display: none;"></textarea>
            <button type="submit" id="submit-comment">Submit</button>
        </form>

        <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
        <script>
            var quill = new Quill('#editor-container', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, false] }],
                        ['bold', 'italic', 'underline'],
                        ['image', 'code-block']
                    ]
                }
            });

            // åœ¨æäº¤è¡¨å•æ—¶ï¼Œå°†å¯Œæ–‡æœ¬å†…å®¹å­˜å…¥éšè—çš„ textarea ä¸­
            document.getElementById('comment-form').addEventListener('submit', function(e) {
                var content = quill.root.innerHTML;
                document.getElementById('comment-content').value = content;
            });
        </script>
        

        <!-- åˆ†é¡µæŒ‰é’® -->
        <div class="pagination">
            <span class="step-links">
                {% if comments.has_previous %}
                    <a href="?page=1">&laquo; ç¬¬ä¸€é¡µ</a>
                    <a href="?page={{ comments.previous_page_number }}">ä¸Šä¸€é¡µ</a>
                {% endif %}

                <span class="current">
                    ç¬¬ {{ comments.number }} é¡µï¼Œå…± {{ comments.paginator.num_pages }} é¡µ
                </span>

                {% if comments.has_next %}
                    <a href="?page={{ comments.next_page_number }}">ä¸‹ä¸€é¡µ</a>
                    <a href="?page={{ comments.paginator.num_pages }}">æœ€åä¸€é¡µ &raquo;</a>
                {% endif %}
            </span>
        </div>
    </div>
    
    <!-- Bootstrap çš„ JS æ–‡ä»¶ -->
    <script src="../static/bootstrap/js/bootstrap.js"></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
    function likeComment(commentId) {
        $.ajax({
            url: "/like_comment/",  // åç«¯å¤„ç†ç‚¹èµçš„ URL
            type: "POST",
            data: {
                "comment_id": commentId,
                "csrfmiddlewaretoken": "{{ csrf_token }}"  // ç¡®ä¿ Django ä¿æŠ¤ CSRF
            },
            success: function(response) {
                if (response.status === "success") {
                    // æ›´æ–°ç‚¹èµæ•°
                    $("#like-count-" + commentId).text(response.new_like_count);
                } else {
                    alert("ç‚¹èµå¤±è´¥ï¼š" + response.message);
                }
            },
            error: function(xhr, errmsg, err) {
                alert("è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•ï¼");
            }
        });
    }
    </script>


    <div style="text-align: center; margin-top: 20px;">
        <a href="https://beian.miit.gov.cn/" target="_blank">å¤‡æ¡ˆå·ï¼šé—½ICPå¤‡2024029524å·-2</a>
    </div>
    

</body>